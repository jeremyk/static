#!/usr/bin/env node

var argv = require('optimist').argv,
  Static = require('../static.js'),
  action = argv._[0];

// Show help prompt if requested or if the 
// incorrect usage options are supplied
if (argv.h || argv.help || !action) {
  console.log(static.help);
  return;
}

if (action === 'create') {
  Static.create(argv._[1]);
} else {
  var static = new Static(argv._[0] || '.');
  if (argv._.length < 2) {
    static.listen(8000);
  } else {
    argv._.slice(1).forEach(function(arg) {
      if (arg && typeof arg === 'number' || arg.match(/^[\d]+$/)) {
        static.listen(arg);
      } else {
        static.publish(arg);
      }
    });
  }
}
